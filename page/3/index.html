<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>k-seito&#39;s memo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="k-seito&#39;s memo">
<meta property="og:url" content="https://kseito.github.io/page/3/index.html">
<meta property="og:site_name" content="k-seito&#39;s memo">
<meta property="og:locale" content="ja_JP">
<meta property="article:author" content="Kazuto Seito">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="k-seito&#39;s memo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">k-seito&#39;s memo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/profile">Profile</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSSフィード"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="検索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://kseito.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-android-memory-leak" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/10/25/android-memory-leak/" class="article-date">
  <time datetime="2020-10-25T12:00:00.000Z" itemprop="datePublished">2020-10-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/25/android-memory-leak/">2020年のAndroidアプリ開発でメモリリークは考慮する必要があるのか</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>同僚とメモリリークの話になり自分の理解不足を痛感したので調査してみました。<br>業務で開発しているアプリはメモリリークの問題で困っていないですが、事前にメモリリークしないようにコードを記述しておけば未然に防げる問題なので学んでおいて損はなさそう。</p>
<h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>動作確認した環境は下記。</p>
<ul>
<li>Android Studio 4.0.1</li>
<li>Pixel 3a XL(Android Emulator) </li>
<li>Android 10</li>
</ul>
<p>また、今回はActivityがメモリリークしているか確認します。<br>試すパターンは下記３つ</p>
<ul>
<li>内部クラスのstatic参照</li>
<li>BroadcastReceiver解除忘れ</li>
<li>インナークラスで親をプロパティ保持</li>
</ul>
<h2 id="メモリリークを検知する方法"><a href="#メモリリークを検知する方法" class="headerlink" title="メモリリークを検知する方法"></a>メモリリークを検知する方法</h2><ol>
<li>アプリ起動</li>
<li>画面を回転する</li>
<li>Android SutdioのProfilerから強制的にGCを走らせる</li>
<li>Activityのfinalizeメソッドが呼ばれるか確認</li>
</ol>
<h2 id="正常系"><a href="#正常系" class="headerlink" title="正常系"></a>正常系</h2><p>まずは空のActivityの時にfinalizeメソッドは呼ばれるのか確認します。</p>
<p><strong>ソースコード</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        Log.d(TAG, <span class="string">&quot;onCreate&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroy</span><span class="params">()</span></span> &#123;</span><br><span class="line">        Log.d(TAG, <span class="string">&quot;onDestroy&quot;</span>)</span><br><span class="line">        <span class="keyword">super</span>.onDestroy()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">fun</span> <span class="title">finalize</span><span class="params">()</span></span> &#123;</span><br><span class="line">        Log.d(TAG, <span class="string">&quot;finalize&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上記のようなコードを書きました。<br>結果は下記のようになります。</p>
<p><strong>結果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D/MainActivity: onCreate</span><br><span class="line">D/MainActivity: onDestroy</span><br><span class="line">D/MainActivity: onCreate</span><br><span class="line">D/MainActivity: finalize</span><br></pre></td></tr></table></figure>
<p>当たり前ですが画面回転を行ってからGCが走ると画面回転前のMainActivityインスタンスは解放されます。</p>
<h2 id="内部クラスのstatic参照"><a href="#内部クラスのstatic参照" class="headerlink" title="内部クラスのstatic参照"></a>内部クラスのstatic参照</h2><p>非staticな内部クラスを親がstaticプロパティとして保持するパターンです。</p>
<p><strong>ソースコード</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> innerClass: SomeInnerClass? = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        Log.d(TAG, <span class="string">&quot;onCreate&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (innerClass == <span class="literal">null</span>) &#123;</span><br><span class="line">            innerClass = SomeInnerClass()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">class</span> <span class="title class_">SomeInnerClass</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>結果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D/MainActivity: onCreate</span><br><span class="line">D/MainActivity: onDestroy</span><br><span class="line">D/MainActivity: onCreate</span><br></pre></td></tr></table></figure>
<p>強制的にGCした時にfinalizeメソッドが呼ばれていないのでメモリリークを起こしています。<br>MainActivityが破棄されても、staticプロパティが生きているので参照が残っているためGCで解放されない、という流れでしょうか。<br>このあたりの挙動はどうすれば確認できるか謎なので割愛。</p>
<h2 id="BroadcastReceiver解除忘れ"><a href="#BroadcastReceiver解除忘れ" class="headerlink" title="BroadcastReceiver解除忘れ"></a>BroadcastReceiver解除忘れ</h2><p>Androidでよくある実装として、各種リスナーやレシーバーをActivityに登録して使うやり方があります。<br>その時、画面終了時に登録解除を忘れたりするとメモリリークするらしいので確認してみます。</p>
<p><strong>ソースコード</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> TAG = MainActivity::<span class="keyword">class</span>.simpleName</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> localBroadcastReceiver: BroadcastReceiver? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        Log.d(TAG, <span class="string">&quot;onCreate&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStart</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onStart()</span><br><span class="line"></span><br><span class="line">        registerBroadCastReceiver()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStop</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onStop()</span><br><span class="line"></span><br><span class="line">          <span class="comment">//あえてレシーバーの登録解除をスキップする</span></span><br><span class="line"><span class="comment">//        if (localBroadcastReceiver != null) &#123;</span></span><br><span class="line"><span class="comment">//            unregisterReceiver(localBroadcastReceiver)</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">registerBroadCastReceiver</span><span class="params">()</span></span> &#123;</span><br><span class="line">        localBroadcastReceiver = <span class="keyword">object</span> : BroadcastReceiver() &#123;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onReceive</span><span class="params">(context: <span class="type">Context</span>, intent: <span class="type">Intent</span>)</span></span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        registerReceiver(</span><br><span class="line">            localBroadcastReceiver,</span><br><span class="line">            IntentFilter(<span class="string">&quot;android.net.conn.CONNECTIVITY_CHANGE&quot;</span>)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>結果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D/MainActivity: onCreate</span><br><span class="line">D/MainActivity: onDestroy</span><br><span class="line">D/MainActivity: onCreate</span><br></pre></td></tr></table></figure>
<p>画面回転後にGCを走らせてもfinalizeメソッドが呼ばれませんでした。<br>これはBroadcastReceiverがActivityの強参照を保持しているかららしいです。</p>
<h2 id="インナークラスで親をプロパティ保持"><a href="#インナークラスで親をプロパティ保持" class="headerlink" title="インナークラスで親をプロパティ保持"></a>インナークラスで親をプロパティ保持</h2><p><strong>ソースコード</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> TAG = MainActivity::<span class="keyword">class</span>.simpleName</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> innerClass: InnerClass</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        Log.d(TAG, <span class="string">&quot;onCreate&quot;</span>)</span><br><span class="line"></span><br><span class="line">        innerClass = InnerClass()</span><br><span class="line">        innerClass.activity = <span class="keyword">this</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroy</span><span class="params">()</span></span> &#123;</span><br><span class="line">        Log.d(TAG, <span class="string">&quot;onDestroy&quot;</span>)</span><br><span class="line">        <span class="keyword">super</span>.onDestroy()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">fun</span> <span class="title">finalize</span><span class="params">()</span></span> &#123;</span><br><span class="line">        Log.d(TAG, <span class="string">&quot;finalize&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">class</span> <span class="title class_">InnerClass</span> &#123;</span><br><span class="line">        <span class="keyword">lateinit</span> <span class="keyword">var</span> activity: Activity</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>結果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D/MainActivity: onCreate</span><br><span class="line">D/MainActivity: onDestroy</span><br><span class="line">D/MainActivity: onCreate</span><br><span class="line">D/MainActivity: finalize</span><br></pre></td></tr></table></figure>
<p>MainActivityとInnerClass間で循環参照になっているのにGCで問題なく解放されてますね・・・謎<br>BroadcastReceiverと事情は同じはずなのでメモリリークすると思ってました。<br>昔はこれでメモリリークしてたようなのですが、今現在は問題ないようです。</p>
<h2 id="所感"><a href="#所感" class="headerlink" title="所感"></a>所感</h2><p>公式の<a target="_blank" rel="noopener" href="https://source.android.google.cn/devices/tech/dalvik/gc-debug?hl=ja">GCに関する情報</a>を確認する限りAndroid 10でも変更が入ってたりするのでそのあたりの変更により以前に比べてメモリリークしにくくなっているのかなぁと推測します。<br>また、ハードウェアの進化でヒープ領域が以前に比べて大きくなったことも考慮すると、メモリリークに対してそこまで神経質にならなくても良いのではと思います。<br>それよりも昨今Androidアプリ開発だとアーキテクチャがどうとかクラス間が疎結合になってるとか可読性とか責務の分離とか、そう言った事柄の方が重視されてる気がします。<br>メモリやヒープを気にしなくてよくなった結果、コードの中身を考える余裕ができアーキテクチャが重視されるようになったと考えると、コードの中身が整ったら次は何が重視されるのだろうかとふと思いました。<br>全然まとまってないけど終わり。</p>
<h2 id="参考サイト"><a href="#参考サイト" class="headerlink" title="参考サイト"></a>参考サイト</h2><p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/memory-leaks-in-android/">https://www.geeksforgeeks.org/memory-leaks-in-android/</a><br><a target="_blank" rel="noopener" href="https://qiita.com/amay077/items/3df253f66724c56faaff">https://qiita.com/amay077/items/3df253f66724c56faaff</a><br><a target="_blank" rel="noopener" href="https://tomokey.blogspot.com/2011/05/android.html">https://tomokey.blogspot.com/2011/05/android.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kseito.github.io/2020/10/25/android-memory-leak/" data-id="clbf1y9gi0002c6n16liz9kxr" class="article-share-link">共有</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-image-capture-from-android-10" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/09/16/image-capture-from-android-10/" class="article-date">
  <time datetime="2020-09-16T09:30:00.000Z" itemprop="datePublished">2020-09-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/09/16/image-capture-from-android-10/">Android 10でIntentを使ってキャプチャした画像を外部フォルダに任意のディレクトリを作って保存する</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今更ながらAndroid 10以降で<code>Intent(MediaStore.ACTION_IMAGE_CAPTURE)</code>を使ってキャプチャした画像を、各メディア直下のディレクトリではなくアプリ専用のディレクトリを作って保存する方法について調べました。</p>
<h2 id="準備"><a href="#準備" class="headerlink" title="準備"></a>準備</h2><p>まずxmlの設定から。<code>AndroidManifest.xml</code>をいじります。<br><code>AndroidManifest.xml</code>の<code>&lt;application&gt;</code>タグ内にFileProviderの記述を追加します。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;androidx.core.content.FileProvider&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:authorities</span>=<span class="string">&quot;$&#123;applicationId&#125;.provider&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:grantUriPermissions</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:name</span>=<span class="string">&quot;android.support.FILE_PROVIDER_PATHS&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:resource</span>=<span class="string">&quot;@xml/file_provider&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>&lt;meta-data&gt;</code>タグ内で参照している<code>file_provider.xml</code>はres&#x2F;xml配下に作成し中身は下記のようになっています。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">paths</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">external-path</span> <span class="attr">name</span>=<span class="string">&quot;images&quot;</span> <span class="attr">path</span>=<span class="string">&quot;Pictures/Hoge&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">paths</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Uri取得"><a href="#Uri取得" class="headerlink" title="Uri取得"></a>Uri取得</h2><p>次に画像の保存先をMediaStoreから取得します。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> fileName = <span class="string">&quot;hoge.jpg&quot;</span></span><br><span class="line"><span class="keyword">val</span> values = ContentValues()</span><br><span class="line">values.put(MediaStore.Images.Media.DISPLAY_NAME, fileName)</span><br><span class="line">values.put(</span><br><span class="line">    MediaStore.Images.Media.RELATIVE_PATH,</span><br><span class="line">    Environment.DIRECTORY_PICTURES + File.separator + <span class="string">&quot;Hoge&quot;</span></span><br><span class="line">)</span><br><span class="line">values.put(MediaStore.Images.Media.MIME_TYPE, <span class="string">&quot;image/*&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> contentUri = MediaStore.Images.Media.getContentUri(MediaStore.VOLUME_EXTERNAL)</span><br><span class="line">imageUri = contentResolver.insert(contentUri, values)</span><br></pre></td></tr></table></figure>
<p><code>RELATIVE_PATH</code>は<code>file_provider.xml</code>で記述した<code>path</code>の値と同じにします。<br><code>imageUri</code>はプロパティとして保持しておき<code>onActivityResult</code>で再利用します。</p>
<h2 id="Intentを投げる"><a href="#Intentを投げる" class="headerlink" title="Intentを投げる"></a>Intentを投げる</h2><p>事前に取得しておいたUriをIntentにくっつけて投げます。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> intent = Intent(MediaStore.ACTION_IMAGE_CAPTURE)</span><br><span class="line">intent.putExtra(MediaStore.EXTRA_OUTPUT, imageUri)</span><br><span class="line">startActivityForResult(intent, REQUEST_CODE)</span><br></pre></td></tr></table></figure>
<p>カメラアプリがいくつか候補に出てくると思うので好きなアプリを選択して写真を撮ります。</p>
<h2 id="戻り値を受け取る"><a href="#戻り値を受け取る" class="headerlink" title="戻り値を受け取る"></a>戻り値を受け取る</h2><p><code>ImageDecoder</code>というクラスを使って<code>Bitmap</code>を生成して、<code>ImageView</code>にセットすれば終わりです。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (requestCode == REQUEST_CODE &amp;&amp; resultCode == Activity.RESULT_OK) &#123;</span><br><span class="line">    <span class="keyword">val</span> source = ImageDecoder.createSource(contentResolver, imageUri!!)</span><br><span class="line">    <span class="keyword">val</span> bitmap = ImageDecoder.decodeBitmap(source)</span><br><span class="line">    findViewById&lt;ImageView&gt;(R.id.image).setImageBitmap(bitmap)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="感想"><a href="#感想" class="headerlink" title="感想"></a>感想</h2><p>公式動画やブログでも再三言われていたことですが、Google的にはファイルパスは極力使わないでUriを使って画像を扱って欲しいのだなと改めて思う内容でした。<br>近い将来、動画をファイルパスでしか読み込めないライブラリたちがUriをサポートしたらファイルパスの参照も禁止になってしまうのかもしれません。<br>そう考えるとできるだけファイルパスに依存しない実装にしておくのが吉なのでしょう。知らんけど。</p>
<h2 id="参考サイト"><a href="#参考サイト" class="headerlink" title="参考サイト"></a>参考サイト</h2><ul>
<li><a target="_blank" rel="noopener" href="https://developer.android.com/about/versions/11/privacy/storage#other-apps-private-dirs">https://developer.android.com/about/versions/11/privacy/storage#other-apps-private-dirs</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.android.com/training/data-storage/app-specific#external">https://developer.android.com/training/data-storage/app-specific#external</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.android.com/training/secure-file-sharing/setup-sharing?hl=ja">https://developer.android.com/training/secure-file-sharing/setup-sharing?hl=ja</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/56651444/deprecated-getbitmap-with-api-29-any-alternative-codes">https://stackoverflow.com/questions/56651444/deprecated-getbitmap-with-api-29-any-alternative-codes</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kseito.github.io/2020/09/16/image-capture-from-android-10/" data-id="clbf1y9gp000vc6n1e3zbficy" class="article-share-link">共有</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-android-video-player-speed-control" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/21/android-video-player-speed-control/" class="article-date">
  <time datetime="2020-08-21T12:00:00.000Z" itemprop="datePublished">2020-08-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/21/android-video-player-speed-control/">Androidで動画の再生速度を変更する</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><code>MediaPlayer</code>の動画再生速度をいじりたかったけど、アプリの<code>minSdkVersion</code>が21で<a target="_blank" rel="noopener" href="https://developer.android.com/reference/android/media/MediaPlayer#setPlaybackParams(android.media.PlaybackParams)">setPlaybackParams</a>を使えない（左記メソッドはAPI level 23以上必要）時の対処法について書きます。</p>
<p>結論から言うと<a target="_blank" rel="noopener" href="https://github.com/google/ExoPlayer">ExoPlayer</a>を使いました。<br>既に画面がある場合は辛いかもですが新規で動画プレイヤー画面を作る場合は、MediaPlayer・ExoPlayerどちらを使っても実装工数は変わらない印象です。<br>機能的にはExoPlayerの方が柔軟にカスタマイズできて便利そうです。詳しくは<a target="_blank" rel="noopener" href="https://exoplayer.dev/pros-and-cons.html">こちら</a><br>ExoPlayerの場合は<a target="_blank" rel="noopener" href="https://exoplayer.dev/doc/reference/com/google/android/exoplayer2/testutil/Action.SetPlaybackParameters.html">setPlaybackParameters</a>を使って動画の再生速度を変更できました。</p>
<h2 id="参考サイト"><a href="#参考サイト" class="headerlink" title="参考サイト"></a>参考サイト</h2><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/10849961/speed-control-of-mediaplayer-in-android">https://stackoverflow.com/questions/10849961/speed-control-of-mediaplayer-in-android</a><br><a target="_blank" rel="noopener" href="https://codelabs.developers.google.com/codelabs/exoplayer-intro/#0">https://codelabs.developers.google.com/codelabs/exoplayer-intro/#0</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kseito.github.io/2020/08/21/android-video-player-speed-control/" data-id="clbf1y9gl0009c6n10xu13l7g" class="article-share-link">共有</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-crashlytics-migration" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/08/crashlytics-migration/" class="article-date">
  <time datetime="2020-07-08T00:00:00.000Z" itemprop="datePublished">2020-07-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/08/crashlytics-migration/">Fabric Crashlytics SDKからFirebase Crashlytics SDKに乗り換えるときのTODO</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/2020/07/08/crashlytics-migration/official-announcement.png" alt="公式アナウンス"></p>
<p>どうやらFabric製Crashlyticsが使えるのも今年の11&#x2F;15までになりそうなので、Firebase製のCrashlyticsに移行してみました。</p>
<h3 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h3><ul>
<li>Fabric製Crashlyticsを現在進行形で使っている</li>
<li>Firebaseとの連携が住んでいる</li>
</ul>
<h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h3><p><a target="_blank" rel="noopener" href="https://firebase.google.com/docs/crashlytics/upgrade-sdk?hl=en&platform=android">移行ドキュメント</a>を見る限り、コードの置き換えは必要なものの機械的に置き換えていけばそんなに時間掛からなそうな印象でした。<br>また、移行ドキュメントの日本語訳がまだないようなので英語で確認する必要がありました。<br>TODOは下記。</p>
<ol>
<li>SDKの入れ替え</li>
<li>Applicationクラスの書き換え</li>
<li>Crashlyticsクラスを使ってる箇所の書き換え</li>
</ol>
<p>それぞれ詳しく見ていきましょう。</p>
<h4 id="1-SDKの入れ替え"><a href="#1-SDKの入れ替え" class="headerlink" title="1. SDKの入れ替え"></a>1. SDKの入れ替え</h4><p><a target="_blank" rel="noopener" href="https://firebase.google.com/docs/crashlytics/upgrade-sdk?hl=en&amp;platform=android#add-crashlytics-sdk">https://firebase.google.com/docs/crashlytics/upgrade-sdk?hl=en&amp;platform=android#add-crashlytics-sdk</a></p>
<p>ルートディレクトリとappディレクトリ内にある<code>build.gradle</code>をいじります。<br>当たり前ですが、この修正以降全てのTODOが完了するまでビルドが通らなくなります。</p>
<h4 id="2-Applicationクラスの書き換え"><a href="#2-Applicationクラスの書き換え" class="headerlink" title="2. Applicationクラスの書き換え"></a>2. Applicationクラスの書き換え</h4><p><a target="_blank" rel="noopener" href="https://firebase.google.com/docs/crashlytics/upgrade-sdk?hl=en&amp;platform=android#fabric_sdk_2">https://firebase.google.com/docs/crashlytics/upgrade-sdk?hl=en&amp;platform=android#fabric_sdk_2</a></p>
<p>Crashlyticsの初期化処理を書き換えます。<br>Fabric API keyは不要になりますので<code>AndroidManifest.xml</code>から削除しておきましょう。</p>
<h4 id="3-Crashlyticsクラスを使ってる箇所の書き換え"><a href="#3-Crashlyticsクラスを使ってる箇所の書き換え" class="headerlink" title="3. Crashlyticsクラスを使ってる箇所の書き換え"></a>3. Crashlyticsクラスを使ってる箇所の書き換え</h4><p><a target="_blank" rel="noopener" href="https://firebase.google.com/docs/crashlytics/upgrade-sdk?hl=en&amp;platform=android#the_new_package_and_classname_for_is_comgooglefirebasecrashlyticsfirebasecrashlytics">https://firebase.google.com/docs/crashlytics/upgrade-sdk?hl=en&amp;platform=android#the_new_package_and_classname_for_is_comgooglefirebasecrashlyticsfirebasecrashlytics</a></p>
<p>コード上の各所で使われていて影響範囲は広かったのですが、機械的に直せそうだったので下記のような一括置換を行いました。</p>
<p><strong>インポート文修正</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Before</span></span><br><span class="line"><span class="keyword">import</span> com.crashlytics.android.Crashlytics</span><br><span class="line"></span><br><span class="line"><span class="comment">// After</span></span><br><span class="line"><span class="keyword">import</span> com.google.firebase.crashlytics.FirebaseCrashlytics</span><br></pre></td></tr></table></figure>
<p><strong>インスタンスの取得方法変更</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Before</span></span><br><span class="line">Crashlytics.log()</span><br><span class="line"></span><br><span class="line"><span class="comment">// After</span></span><br><span class="line">FirebaseCrashlytics.getInstance().log()</span><br></pre></td></tr></table></figure>
<p>後は動作確認して終わり。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kseito.github.io/2020/07/08/crashlytics-migration/" data-id="clbf1y9gq0014c6n1727h594u" class="article-share-link">共有</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-teaching-is-important" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/03/teaching-is-important/" class="article-date">
  <time datetime="2020-04-03T06:00:00.000Z" itemprop="datePublished">2020-04-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/04/03/teaching-is-important/">教えることの大切さを知る</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>最近、<a target="_blank" rel="noopener" href="https://medium.com/accelerated-intelligence/memory-learning-breakthrough-it-turns-out-that-the-ancients-were-right-7bbd3090d9cc">この記事</a>が自分の中で空前の大ブームになっている。<br>今までなんとなく人に教えることやアウトプットすることは大事だと思っていたが、なぜの部分が腑に落ちていなかった。<br>この記事を読んで、なるほど！という感じで腹落ちした気がした。後は偉人たちもやってるよ、という部分に説得力を感じてしまったけどこれは日本人特有の釣られ方かもしれない。</p>
<h2 id="自分にできそうなこと"><a href="#自分にできそうなこと" class="headerlink" title="自分にできそうなこと"></a>自分にできそうなこと</h2><p>学びたいことは主にITに関することという前提に立つと、記事を読んで自分に出来そうだと思った教える系の行為は</p>
<ul>
<li>ラバーダッキング</li>
<li>ブログを書く</li>
<li>ジャーナリング（雑なブログ）</li>
</ul>
<p>あたりかなぁ。他人に教えることが一番とは書いてあるものの、学習中の事柄なので上手に説明することが難しいこともありそう。と考えると他人に教えるのは気が引ける。<br>まずは上記３つをやってみてチャンスがあれば社内勉強会とか社外LTとかで他人に話す・教える行為もすると良さそう。<br>やる意思はあるけどとても億劫に感じるのはアウトプットが習慣化できていないことが問題な気がするので、まずは量をこなしてアウトプット量を増やすのが大事そうな気がする。<br>がんばるぞい。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kseito.github.io/2020/04/03/teaching-is-important/" data-id="clbf1y9gs001nc6n15lfd6v1f" class="article-share-link">共有</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-android-sharedpreferences-performance" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/11/android-sharedpreferences-performance/" class="article-date">
  <time datetime="2020-02-11T00:23:21.000Z" itemprop="datePublished">2020-02-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/02/11/android-sharedpreferences-performance/">SharedPreferencesの保存速度を計測してみた</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>SharedPreferencesの処理はUIスレッドに割と書いたりしますが、保存する回数や文字列の長さが増えて問題ないのか確かめてみました。<br>下記のようなコードで <code>wordCount</code>の値を調整する感じです。<br>５回計測を行い平均値を出してみます。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> wordCount = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">(<span class="number">0</span> until <span class="number">10_000</span>).forEach &#123;</span><br><span class="line">    <span class="keyword">val</span> prefs = getSharedPreferences(<span class="string">&quot;hoge&quot;</span>, Context.MODE_PRIVATE)</span><br><span class="line">    prefs.edit().putString(<span class="string">&quot;save_value&quot;</span>, <span class="string">&quot;a&quot;</span>.repeat(wordCount)).apply()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="実行環境"><a href="#実行環境" class="headerlink" title="実行環境"></a>実行環境</h2><ul>
<li>Androidエミュレータ（Pixel2 API 28）</li>
<li>RAM 1536MB</li>
</ul>
<h2 id="結果"><a href="#結果" class="headerlink" title="結果"></a>結果</h2><h3 id="wordCount-x3D-1"><a href="#wordCount-x3D-1" class="headerlink" title="wordCount&#x3D;1"></a>wordCount&#x3D;1</h3><p>(1907 + 2065 + 1907 + 1833 + 1917) &#x2F; 5 &#x3D; 1925.8ms</p>
<h3 id="wordCount-x3D-100"><a href="#wordCount-x3D-100" class="headerlink" title="wordCount&#x3D;100"></a>wordCount&#x3D;100</h3><p>(1818 + 1742 + 1806 + 1779 + 1797) &#x2F; 5 &#x3D; 1788.4ms</p>
<h3 id="wordCount-x3D-10000"><a href="#wordCount-x3D-10000" class="headerlink" title="wordCount&#x3D;10000"></a>wordCount&#x3D;10000</h3><p>(3542 + 3694 + 3708 + 4433 + 3915) &#x2F; 5 &#x3D; 3858.4ms</p>
<h3 id="おまけ-ループ回数-x3D-1-00-000-wordCount-x3D-100"><a href="#おまけ-ループ回数-x3D-1-00-000-wordCount-x3D-100" class="headerlink" title="おまけ(ループ回数&#x3D;1_00_000, wordCount&#x3D;100)"></a>おまけ(ループ回数&#x3D;1_00_000, wordCount&#x3D;100)</h3><p>(13859 + 12701 + 12809 + 12754 + 13489) &#x2F; 5 &#x3D; 13122.4ms</p>
<h2 id="感想"><a href="#感想" class="headerlink" title="感想"></a>感想</h2><p>保存する回数や文字列の長さにより保存にかかる時間は増えました。<br>しかし文字数は１万文字を１回保存するのに0.4msぐらいなのでUIスレッドで実行しても問題なさそうです。<br>WEB APIから受け取ったJsonをString配列としてキー名を分けて<code>SharedPreferences</code>に保存するとかそれくらいやばいことをすれば話は別ですが・・・<br>結論、<code>SharedPreferences</code>の保存処理はUIスレッドを考慮しなくていいくらい早い。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kseito.github.io/2020/02/11/android-sharedpreferences-performance/" data-id="clbf1y9gj0004c6n1bxpb4by4" class="article-share-link">共有</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-kotlin-inline-function" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/14/kotlin-inline-function/" class="article-date">
  <time datetime="2020-01-14T00:00:00.000Z" itemprop="datePublished">2020-01-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/14/kotlin-inline-function/">Kotlinのインライン関数のパフォーマンスを測ってみた</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>インライン関数の存在自体は前から知っていたのですが、使うことでどれくらいパフォーマンスが向上するのかわからなかったので調べてみました。</p>
<h2 id="測定環境"><a href="#測定環境" class="headerlink" title="測定環境"></a>測定環境</h2><ul>
<li>OS -&gt; Mac 10.14.6</li>
<li>CPU -&gt; Intel Core i9(2.9GHz)</li>
<li>メモリ -&gt; 32GB</li>
</ul>
<h2 id="インライン関数とは"><a href="#インライン関数とは" class="headerlink" title="インライン関数とは"></a>インライン関数とは</h2><p>そもそもインライン関数とは、インライン展開を指示するような記述のある関数のことです。<br>インライン展開とは、呼び出す側に対象の関数の中身を記述することで、関数呼び出しにかかるオーバーヘッドを無くすようなコンパイラの動作を指します。</p>
<h2 id="実験"><a href="#実験" class="headerlink" title="実験"></a>実験</h2><p>インライン関数と非インライン関数の速度を比較するために下記のようなコードを準備しました。<br>３回計測して平均値を取得してみます。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">hoge</span><span class="params">(x: <span class="type">Int</span>, y: <span class="type">Int</span>, function: (<span class="type">a</span>: <span class="type">Int</span>, <span class="type">b</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">    function(x, y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>この関数をまずはこのまま1億回呼んでみます。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1.</span><span class="number">.100_000_000</span>).map &#123;</span><br><span class="line">    hoge(it, it) &#123; a, b -&gt; a + b &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>速度は、(1009+963+945)&#x2F;3&#x3D;972.3msでした。<br>次に<code>inline</code>修飾子をつけて試してみます。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">hoge</span><span class="params">(x: <span class="type">Int</span>, y: <span class="type">Int</span>, function: (<span class="type">a</span>: <span class="type">Int</span>, <span class="type">b</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">    function(x, y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>結果は、(872+878+848)&#x2F;3&#x3D;866msでした。</p>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>今回はMacbook Proを使ったこともあり1億回呼び出しして100ms程度の差に留まりましたが、格安スマホなどで試せば差はさらに顕著になるかと思います。<br>何れにせよ、ループ処理の中で高階関数をパラメータに持つ関数を呼びだす場合はインライン関数を使っておいた方がパフォーマンスが良くなることがわかりました。</p>
<h2 id="参考URL"><a href="#参考URL" class="headerlink" title="参考URL"></a>参考URL</h2><p><a target="_blank" rel="noopener" href="https://dogwood008.github.io/kotlin-web-site-ja/docs/reference/lambdas.html">https://dogwood008.github.io/kotlin-web-site-ja/docs/reference/lambdas.html</a><br><a target="_blank" rel="noopener" href="https://qiita.com/sekitaka_1214/items/749f824e04d6fda4733c">https://qiita.com/sekitaka_1214/items/749f824e04d6fda4733c</a><br><a target="_blank" rel="noopener" href="https://qiita.com/satoru_takeuchi/items/5d5eacfd805bd5289311">https://qiita.com/satoru_takeuchi/items/5d5eacfd805bd5289311</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kseito.github.io/2020/01/14/kotlin-inline-function/" data-id="clbf1y9gp000xc6n1a6jm6wvn" class="article-share-link">共有</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Kotlin/" rel="tag">Kotlin</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-mpandroidchart-useage" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/20/mpandroidchart-useage/" class="article-date">
  <time datetime="2019-12-19T23:27:34.000Z" itemprop="datePublished">2019-12-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/20/mpandroidchart-useage/">MPAndroidChartのPieChartをカスタマイズしたかった</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>仕事で<a target="_blank" rel="noopener" href="https://github.com/PhilJay/MPAndroidChart">MPAndroidChart</a>の<code>PieChart</code>を使う機会があったのですが、カスタマイズが思いの外時間がかかったのでメモを残しておきます。<br><code>PieChart</code>は円グラフを表示するUIコンポーネントで、細かな制御が色々できて便利なのですが、メソッド名が直感的ではなく結局ソースコードを読んでどのプロパティを変更すれば期待した動作になるか調査しながら進めました。</p>
<h2 id="やりたかったこと"><a href="#やりたかったこと" class="headerlink" title="やりたかったこと"></a>やりたかったこと</h2><p>まずはじめに、デフォルトの<code>PieChart</code>を表示すると下図のようになります。</p>
<img src="/2019/12/20/mpandroidchart-useage/device-2019-12-20-074904.png" width="320px">

<p>この図に対して下記3点の変更を加えました。</p>
<ul>
<li>円グラフの太さを変更</li>
<li>テキストを中央に配置する</li>
<li>円グラフの中に表示されてる数値を削除する</li>
</ul>
<h3 id="円グラフの太さを変更"><a href="#円グラフの太さを変更" class="headerlink" title="円グラフの太さを変更"></a>円グラフの太さを変更</h3><p><code>PieChart</code>の内部では、まず穴なしの円を書いた後にその円をくり貫くような実装をしています。<br>なので円グラフの太さを変更したい場合はくり抜く円の半径を調整すれば良いです。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pieChart.holeRadius = <span class="number">90f</span></span><br></pre></td></tr></table></figure>
<p>元の円の何パーセントをくり抜くかというプロパティを変更することで実現できます。デフォルト５０％なので９０％にすると細くなります。</p>
<h3 id="テキストを中央に配置する"><a href="#テキストを中央に配置する" class="headerlink" title="テキストを中央に配置する"></a>テキストを中央に配置する</h3><p>円グラフの中央にテキストを配置するということはよくあると思います。<br><code>PieChart</code>とは別にビューを作れば良いだけではありますが<code>PieChart</code>自身も中央にテキストを配置する機能を持っています。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pieChart.centerText = <span class="string">&quot;Test Text&quot;</span></span><br></pre></td></tr></table></figure>
<p>テキストカラー・サイズを変更するメソッドも生えてるので安心です。</p>
<h3 id="円グラフの中に表示されてる数値を削除する"><a href="#円グラフの中に表示されてる数値を削除する" class="headerlink" title="円グラフの中に表示されてる数値を削除する"></a>円グラフの中に表示されてる数値を削除する</h3><p>これが一番ハマりました。この数値を消すには<code>PieChart</code>ではなく<code>PieDataSet</code>のプロパティを変更する必要があります。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dataSet.setDrawValues(<span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p><code>PieDataSet</code>が内部に持つ<code>mDrawValues</code>を<code>false</code>にすることでデータを描画するときに数値を表示しないようにできます。</p>
<p>上記３つのプロパティを全て変更すると下図のようなグラフになります。</p>
<img src="/2019/12/20/mpandroidchart-useage/device-2019-12-20-074945.png" width="320px">

<h2 id="参考サイト"><a href="#参考サイト" class="headerlink" title="参考サイト"></a>参考サイト</h2><p><a target="_blank" rel="noopener" href="https://github.com/PhilJay/MPAndroidChart">https://github.com/PhilJay/MPAndroidChart</a><br><a target="_blank" rel="noopener" href="https://weeklycoding.com/mpandroidchart-documentation/">https://weeklycoding.com/mpandroidchart-documentation/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kseito.github.io/2019/12/20/mpandroidchart-useage/" data-id="clbf1y9gq0016c6n16rdgelzr" class="article-share-link">共有</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/" rel="tag">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-okhttp-retry-setting" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/03/okhttp-retry-setting/" class="article-date">
  <time datetime="2019-12-03T08:52:05.000Z" itemprop="datePublished">2019-12-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/03/okhttp-retry-setting/">OkHttpのリトライ無効化</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="状況"><a href="#状況" class="headerlink" title="状況"></a>状況</h2><p>Retrofitで通信失敗した時にリトライしてくれてることに最近気がつきました。デフォルトで2回リトライしてくれるようです。<br>しかし、通信箇所によってはリトライしたくない時もあります。そんな時の対処法について調べました。</p>
<h2 id="実装"><a href="#実装" class="headerlink" title="実装"></a>実装</h2><p>OkHttpClient作成時に下記のように<code>retryOnConnectionFailure(false)</code>を設定してあげるとOkHttpClientを使って通信を行う時にリトライしなくなります。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> OkHttpClient <span class="title function_">createOkHttpClient</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OkHttpClient</span>.Builder()</span><br><span class="line">            .connectTimeout(<span class="number">10</span>, TimeUnit.SECONDS)</span><br><span class="line">            .readTimeout(<span class="number">10</span>, TimeUnit.SECONDS)</span><br><span class="line">            .retryOnConnectionFailure(<span class="literal">false</span>)</span><br><span class="line">            .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="補足"><a href="#補足" class="headerlink" title="補足"></a>補足</h2><p>どんな通信エラーの時でもリトライする訳ではなく、タイムアウトなどの特定のエラーの時のみリトライするようです。<br>詳しくは<a target="_blank" rel="noopener" href="https://github.com/square/okhttp/blob/02958768ed9f19f78fa3060ea22c8025c0232242/okhttp/src/main/java/okhttp3/internal/http/RetryAndFollowUpInterceptor.kt#L163">この辺りのコード</a>を見ると分かります。</p>
<h2 id="参考URL"><a href="#参考URL" class="headerlink" title="参考URL"></a>参考URL</h2><p><a target="_blank" rel="noopener" href="https://github.com/square/okhttp/pull/1259">https://github.com/square/okhttp/pull/1259</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kseito.github.io/2019/12/03/okhttp-retry-setting/" data-id="clbf1y9gr001bc6n1ga7q8una" class="article-share-link">共有</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-kotlin-reflection" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/11/22/kotlin-reflection/" class="article-date">
  <time datetime="2019-11-22T00:58:14.000Z" itemprop="datePublished">2019-11-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/11/22/kotlin-reflection/">Kotlin Reflectionに触れてみる</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>AndroidのAPKをアップロードする時に表示されるようになった<a target="_blank" rel="noopener" href="https://developer.android.com/distribute/best-practices/develop/restrictions-non-sdk-interfaces">警告</a>について調べたら、どうやらリフレクションを使ってAndroid SDKに含まれるクラスの公開されていないメソッド、プロパティを参照すると表示される警告らしいということが分かりました。<br>しかし、今までリフレクションは単体テストレベルでプライベートメソッドを無理やりテストするくらいしか試したことがなく、Android SDKで公開されていない情報を本当に参照できるのか疑問に思ったので試してみました。<br><br/></p>
<h2 id="準備"><a href="#準備" class="headerlink" title="準備"></a>準備</h2><h3 id="依存解決"><a href="#依存解決" class="headerlink" title="依存解決"></a>依存解決</h3><p>新しくAndroidプロジェクトを作成後、<code>implementation &quot;org.jetbrains.kotlin:kotlin-reflect:$kotlin_version&quot;</code>を追加して、Kotlinのリフレクションライブラリをインポートする。<br>これでリフレクションを使う準備ができました。</p>
<h3 id="クラス作成"><a href="#クラス作成" class="headerlink" title="クラス作成"></a>クラス作成</h3><p>下記のような、プライベートメソッド・プロパティを持つクラスを作成します。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="keyword">class</span> <span class="title class_">User</span>(<span class="keyword">val</span> id: <span class="built_in">Int</span>, <span class="keyword">val</span> name: String, <span class="keyword">private</span> <span class="keyword">val</span> description: String) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getFullInfo</span><span class="params">()</span></span>: String &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;This user&#x27;s id is <span class="variable">$id</span>, name is <span class="variable">$name</span>&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br/>
<br/>

<h2 id="自作クラスで試す"><a href="#自作クラスで試す" class="headerlink" title="自作クラスで試す"></a>自作クラスで試す</h2><h3 id="メソッドの参照"><a href="#メソッドの参照" class="headerlink" title="メソッドの参照"></a>メソッドの参照</h3><p>Kotlinリフレクションを使って特定のメソッドを呼びだします。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cls.memberFunctions</span><br><span class="line">    .filter &#123; it.name == <span class="string">&quot;getFullInfo&quot;</span> &#125;</span><br><span class="line">    .forEach &#123;</span><br><span class="line">        it.isAccessible = <span class="literal">true</span></span><br><span class="line">        println(<span class="string">&quot;This function name is <span class="subst">$&#123;it.name&#125;</span>. value is <span class="subst">$&#123;it.call(user)&#125;</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="出力"><a href="#出力" class="headerlink" title="出力"></a>出力</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This function name is getFullInfo. value is This user&#x27;s id is 1, name is kseito</span><br></pre></td></tr></table></figure>
<h3 id="プロパティの参照"><a href="#プロパティの参照" class="headerlink" title="プロパティの参照"></a>プロパティの参照</h3><p>Kotlinリフレクションを使って特定のプロパティを参照します。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cls.memberProperties</span><br><span class="line">    .filter &#123; it.name == <span class="string">&quot;description&quot;</span> &#125;</span><br><span class="line">    .forEach &#123;</span><br><span class="line">        it.isAccessible = <span class="literal">true</span></span><br><span class="line">        println(<span class="string">&quot;<span class="subst">$&#123;it.name&#125;</span> value is <span class="subst">$&#123;it.get(user)&#125;</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="出力-1"><a href="#出力-1" class="headerlink" title="出力"></a>出力</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">description value is I love Splatoon!</span><br></pre></td></tr></table></figure>
<br/>
<br/>


<h2 id="TextViewのプロパティ参照"><a href="#TextViewのプロパティ参照" class="headerlink" title="TextViewのプロパティ参照"></a>TextViewのプロパティ参照</h2><p>最後にAndroid SDKに含まれるクラスです。<br>みんな大好きTextViewのプライベートプロパティに対してリフレクションを使ってみます。<br>本来なら<code>getText()</code>で取得するテキストをリフレクションを使ってプロパティ参照してみます。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> textView = findViewById&lt;TextView&gt;(R.id.text_view)</span><br><span class="line"><span class="keyword">val</span> cls2 = TextView::<span class="keyword">class</span></span><br><span class="line"><span class="title class_">cls2</span>.<span class="title">memberProperties</span></span><br><span class="line">    .filter &#123; it.name == <span class="string">&quot;mText&quot;</span> &#125;</span><br><span class="line">    .forEach &#123;</span><br><span class="line">        it.isAccessible = <span class="literal">true</span></span><br><span class="line">        println(<span class="string">&quot;<span class="subst">$&#123;it.name&#125;</span> value is <span class="subst">$&#123;it.get(textView)&#125;</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="出力-2"><a href="#出力-2" class="headerlink" title="出力"></a>出力</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mText value is Hello World!</span><br></pre></td></tr></table></figure>
<p>無事取得できました。</p>
<p>サンプルソースは<a target="_blank" rel="noopener" href="https://github.com/kseito/ReflectionPractice">こちら</a></p>
<h2 id="参考サイト"><a href="#参考サイト" class="headerlink" title="参考サイト"></a>参考サイト</h2><p><a target="_blank" rel="noopener" href="https://qiita.com/HIkaruSato/items/d9a9b0ca4b1da77221fbjkjkjkjkaaaaa">https://qiita.com/HIkaruSato/items/d9a9b0ca4b1da77221fbjkjkjkjkaaaaa</a><br><a target="_blank" rel="noopener" href="https://qiita.com/KeithYokoma/items/9e692808095acf560bc9">https://qiita.com/KeithYokoma/items/9e692808095acf560bc9</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://kseito.github.io/2019/11/22/kotlin-reflection/" data-id="clbf1y9gp0012c6n17nt4ck9e" class="article-share-link">共有</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&amp;laquo; 戻る</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">次へ &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">タグ</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/" rel="tag">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android-Studio/" rel="tag">Android Studio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cocoapods/" rel="tag">Cocoapods</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Groovy/" rel="tag">Groovy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jetpack-Compose/" rel="tag">Jetpack Compose</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KMM/" rel="tag">KMM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kotlin/" rel="tag">Kotlin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mockito/" rel="tag">Mockito</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Raspberry-Pi/" rel="tag">Raspberry Pi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rust/" rel="tag">Rust</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%87%AA%E4%BD%9CPC/" rel="tag">自作PC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9B%BB%E5%AD%90%E5%B7%A5%E4%BD%9C/" rel="tag">電子工作</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">タグクラウド</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/Android-Studio/" style="font-size: 10px;">Android Studio</a> <a href="/tags/Cocoapods/" style="font-size: 10px;">Cocoapods</a> <a href="/tags/Groovy/" style="font-size: 10px;">Groovy</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Jetpack-Compose/" style="font-size: 15px;">Jetpack Compose</a> <a href="/tags/KMM/" style="font-size: 10px;">KMM</a> <a href="/tags/Kotlin/" style="font-size: 10px;">Kotlin</a> <a href="/tags/Mockito/" style="font-size: 10px;">Mockito</a> <a href="/tags/Raspberry-Pi/" style="font-size: 10px;">Raspberry Pi</a> <a href="/tags/Rust/" style="font-size: 10px;">Rust</a> <a href="/tags/%E8%87%AA%E4%BD%9CPC/" style="font-size: 10px;">自作PC</a> <a href="/tags/%E9%9B%BB%E5%AD%90%E5%B7%A5%E4%BD%9C/" style="font-size: 10px;">電子工作</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">アーカイブ</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最近の投稿</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/09/13/deploy-kmm-library-via-specs-repo/">Kotlin Multiplatform Mobileで作成したライブラリをSpecs Repoを使って配布する時の設定</a>
          </li>
        
          <li>
            <a href="/2022/02/26/variable-length-array-cost-in-rust/">Rustの可変長配列を使用するときのコストについて</a>
          </li>
        
          <li>
            <a href="/2022/02/10/disable-touch-event-in-jetpack-compose/">Composableのイベント伝達を止める</a>
          </li>
        
          <li>
            <a href="/2022/01/15/how-to-detect-multitouch-in-jetpack-compose/">Jetpack Composeでマルチタップを検知する</a>
          </li>
        
          <li>
            <a href="/2021/12/19/compose-horizontalpager-workaround/">HorizontalPagerで最初に表示するページを指定する</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Kazuto Seito<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/profile" class="mobile-nav-link">Profile</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>